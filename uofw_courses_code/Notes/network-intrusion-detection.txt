                   FAQ: Network Intrusion Detection Systems
                                       
   Version 0.3, January 1, 1998
   
   This FAQ is intended to answer simple questions related to detecting
   intruders attacking systems remotely from across the network. FAQ:
   Network Intrusion Detection Systems
   0. Information about this FAQ
   0.1 Copyright
   0.6 Where to get it
   0.7 Thanks to
   0.8 Version History
   0.9 Other resources
   1. Introduction
   1.1 What is a "network intrusion detection system (NIDS)"?
   1.2 Who is misusing the system?
   1.3 How do intruders get into systems?
   1.4 Why can intruders get into systems?
   1.4.1 Software bugs
   1.4.2 System configuration
   1.4.3 Password cracking
   1.4.4 Sniffing unsecured traffic
   1.5 How do intruders get passwords?
   1.6 What is a typical intrusion scenario?
   1.7 What are some common "intrusion signatures"?
   1.8 What are some common exploits?
   1.8.1 CGI scripts
   1.8.2 Web server attacks
   1.8.3 Web browser attacks
   1.8.4 SMTP (SendMail) attacks
   1.8.5 Access
   1.8.6 IMAP
   1.8.7 IP spoofing
   1.8.8 Buffer Overflows
   1.8.9 DNS attacks
   1.9 What are some common reconnaisance scans?
   1.9.1 Ping sweeps
   1.9.2 TCP scans
   1.9.3 UDP scans
   1.9.4 OS identification
   1.10 What are some common DoS (Denial of Service) attacks?
   1.10.1 Ping-of-Death
   1.10.2 SYN Flood
   1.10.3 Land/Latierra
   1.10.4 WinNuke
   1.11 How much danger from intrusions is there?
   2. Architecture
   2.1 How are intrusions detected?
   2.2 How does a NIDS match signatures with incoming traffic?
   2.3 What are the limitations of network intrusion detection systems?
   2.4 What happens after a NIDS detects an attack?
   2.5 What other countermeasures besides IDS are there?
   2.6 Where do I put IDS systems on my network?
   3. Policy
   3.1 How do I increase intrusion detection/prevention under WinNT?
   3.2 How do I increase intrusion detection/prevention under
   Win95/Win98?
   3.3 How do I increase intrusion detection/prevention under UNIX?
   3.4 How do I increase intrusion detection/prevention under Macintosh?
   3.5 How do I increase intrusion detection/prevention for the
   enterprise?
   3.6 How should I implement intrusion detection my enterprise?
   3.7 What should I do when I've been hacked?
   3.8 How should I respond when somebody tells me they've been hacked
   from my site?
   3.9 How do I collect enough evidence about the hacker?
   4. Products
   4.1 What freeware/shareware intrusion detection systems are available?
   4.1.1 Network Flight Recorder (NFR)
   4.1.1 Bro
   4.1.2 AAFID
   4.1.3 Shadow
   4.1.4 Argus
   4.1.n Others
   4.2 What commercial intrusion detection systems are available?
   4.2.1 CyberCop by Network Associates, Inc.
   4.2.2 RealSecure by Internet Security Systems (ISS), Inc.
   4.2.3 NetRanger by WheelGroup/Cisco
   4.2.4 Netective by Netect
   4.2.4 SessionWall-3 by AbirNet/Memco
   4.2.5 ID-Trak by Internet Tools, Inc.
   4.2.6 SecureNet Pro by MimeStart
   4.2.8 Kane Security Monitor (KSM) by Security Dynamics
   4.2.7 Network Flight Recorder
   4.3 What tools do intruders use to break into my systems?
   4.3.1 UNIX utilities
   4.3.2 WinNT utilities
   4.3.3 Hacking-specific utilities
   4.2 What other free/shareware intrusion detection products should I be
   aware of?
   4.2.1 tcpwrappers
   6. Resources
   6.1 Where can I find updates about new security holes?
   6.1.1 CERT (Computer Emergency Response Team)
   6.1.2 AUSCERT (AUStralian Computer Emergency Response Team)
   6.1.3 CIAC (Computer Incident Advisory Capability) by US Department of
   Energy
   6.2 What are some other security and intrusion detection resources?
   6.2.1 Purdue's COAST archive
   6.2.2 SANS Institute
   6.2.3 L0pht Heavy Industries
   6.2.4 Technical Incursion Countermeasures
   6.2.5 IDS mailing list
   6.3 What are some sites that are interesting?
   6.3.1 NIH security site
   6.3.2 NTSecurity.net
   7. Other
   7.1 What are some problems with IDS?
   7.1.1 Slow scans
   7.1.2 Loaded segments
   7.1.3 Switched networks
   7.1.4 Coordinated, low-bandwidth attacks
   7.2 If I have a firewall, do I need intrusion detection?
   7.2 If I have a intrusion detection, do I need firewall?
   7.3 What are some standardization/interoperability efforts?
   7.3.1 COAST audit trails format
   7.3.2 Universal Format for Logger Messages
   7.3.3 IETF Intrusion Detection Working Group
   7.3.4 CIDF (Common Intrusion Detection Framework)
   
                         0. Information about this FAQ
                                       
0.1 Copyright

     Copyright 1998-1999 by Robert Graham
     (robert_david_graham@yahoo.com. All rights reserved. This document
     may be only be reproduced (whole or in part) for non-commercial
     purposes. All reproductions must contain this copyright notice.
   
0.6 Where to get it

  My homepage:
  http://www.robertgraham.com/pubs/network-intrusion-detection.html
  http://www.robertgraham.com/pubs/network-intrusion-detection.txt
  TICM http://www.ticm.com/kb/faq/
   
0.7 Thanks to

          Thanks to the following people for helpful info and comments
          (note: to avoid automated spam address collection systems, I've
          munged their e-mail addresses in an obvious way).
          Olaf Schreck <chakl at syscall dot de>
          John Kozubik <john_kozubik at hotmail dot com> (see
          http://www.networkcommand.com/john/index.html for NT
          login-script tips).
          Aaron Bawcom <abawcom at pacbell dot net>
          Mike Kienenberger <mkienenb at arsc dot edu>
   
0.8 Version History

        Version 0.3, January 1, 1998
                Minor updates
                Changed format of hyper-links so I can create a text-only
                version of the FAQ.
                Changed embedded e-mail address so that spam-trollers
                can't extract them.
                Added TOC.
                
        Version 0.2, November 1, 1998
                Minor updates
                
        Version 0.1, August 1, 1998
                The first version.
                
0.9 Other resources

          + Michael Sobirey's Intrusion Detection Systems page
            http://www-rnks.informatik.tu-cottbus.de/~sobirey/ids.html
          + Purdue COAST IDS page
            http://www.cs.purdue.edu/coast/hotlist/intrusion_detection/
   
                                1. Introduction
                                       
1.1 What is a "network intrusion detection system (NIDS)"?

          An intrusion is somebody (A.K.A. "hacker" or "cracker")
          attempting to break into or misuse your system. The word
          "misuse" is broad, and can reflect something severe as stealing
          confidential data to something minor such as misusing your
          email system for spam (though for many of us, that is a major
          issue!).
          An "Intrusion Detection System (IDS)" is a system for detecting
          such intrusions. For the purposes of this FAQ, IDS can be
          broken down into the following categories:
          network intrusion detection systems (NIDS) monitors packets on
          the network wire and attempts to discover if a hacker/cracker
          is attempting to break into a system (or cause a denial of
          service attack). A typical example is a system that watches for
          large number of TCP connection requests (SYN) to many different
          ports on a target machine, thus discovering if someone is
          attempting a TCP port scan. A NIDS may run either on the target
          machine who watches its own traffic (usually integrated with
          the stack and services themselves), or on an independent
          machine promiscuously watching all network traffic (hub,
          router, probe). Note that a "network" IDS monitors many
          machines, whereas the others monitor only a single machine (the
          one they are installed on).
          system integrity verifiers (SIV) monitors system files to find
          when a intruder changes them (thereby leaving behind a
          backdoor). The most famous of such systems is "Tripwire". A SIV
          may watch other components as well, such as the Windows
          registry and chron configuration, in order to find well know
          signatures.
          log file monitors (LFM) monitor log files generated by network
          services. In a similar manner to NIDS, these systems look for
          patterns in the log files that suggest an intruder is
          attacking. A typical example would be a parser for HTTP server
          log files that looking for intruders who try well-known
          security holes, such as the "phf" attack. Example: swatch
          deception systems (lures, fly-traps) which contain
          pseudo-services whose goal is to emulate well-known holes in
          order to entrap hackers. See The Deception ToolKit
          http://www.all.net/dtk/ for an example.
   
1.2 Who is misusing the system?

          There are two words to describe the intruder: hacker and
          cracker. A hacker is a generic term for a person who likes
          getting into things. The benign hacker is the person who likes
          to get into his/her own computer and understand how it works.
          The malicious hacker is the person who likes getting into other
          people's systems. The benign hackers wish that the media would
          stop bad-mouthing all hackers and use the term 'cracker'
          instead. Unfortunately, this is not likely to happen. In any
          event, the word used in this FAQ is 'intruder', to generically
          denote anybody trying to get into your systems.
          Intruders can be classified into two categories.
          
        Outsiders
                Intruders from outside your network, and who may attack
                you external presence (deface web servers, forward spam
                through e-mail servers, etc.). They may also attempt to
                go around the firewall to attack machines on the internal
                network. Outside intruders may come from the Internet,
                dial-up lines, physical break-ins, or from partner
                (vendor, customer, reseller, etc.) network that is linked
                to your corporate network.
                
        Insiders
                Intruders that legitimately use your internal network.
                These include users who misuse priviledges (such as the
                Social Security employee who marked someone as being dead
                because they didn't like that person) or who impersonate
                higher privileged users (such as using someone else's
                terminal). A frequently quoted statistic is that 80% of
                security breaches are committed by insiders.
                
          There are several types of intruders Joy riders hack because
          they can. Vandals are intent on causing destruction or marking
          up your web-pages. Profiteers are intent on profiting from
          their enterprise, such as rigging the system to give them money
          or by stealing corporate data and selling it.
   
1.3 How do intruders get into systems?

          The primary ways a intruder can get into a system:
          Physical Intrusion If a intruders have physical access to a
          machine (i.e. they can use the keyboard or take apart the
          system), they will be able to get in. Techniques range from
          special privileges the console has, to the ability to
          physically take apart the system and remove the disk drive (and
          read/write it on another machine). Even BIOS protection is easy
          to bypass: virtually all BIOSes have backdoor passwords.
          System Intrusion This type of hacking assumes the intruder
          already has a low-privilege user account on the system. If the
          system doesn't have the latest security patches, there is a
          good chance the intruder will be able to use a known exploit in
          order to gain additional administrative privileges.
          Remote Intrusion This type of hacking involves a intruder who
          attempts to penetrate a system remotely across the network. The
          intruder begins with no special privileges. There are several
          forms of this hacking. For example, a intruder has a much more
          difficult time if there exists a firewall on between him/her
          and the victim machine.
          Note that Network Intrusion Detection Systems are primarily
          concerned with Remote Intrusion.
   
1.4 Why can intruders get into systems?

          Software always has bugs. System Administrators and Programmers
          can never track down and eliminate all possible holes.
          Intruders have only to find one hole to break in.
          
  1.4.1 Software bugs
  
                Software bugs are exploited in the server daemons, the
                client applications, the operating system, and the
                network stack. Software bugs can be classified in the
                following manner:
                
                Buffer overflows: Almost all the security holes you read
                about in the press are due to this problem. A typical
                example is a programmer who sets aside 256 characters to
                hold a login username. Surely, the programmer thinks,
                nobody will ever have a name longer than that. But a
                hacker thinks, what happens if I enter in a false
                username longer than that? Where do the additional
                characters go? If they hackers do the job just right,
                they can send 300 characters, including code that will be
                executed by the server, and voila, they've broken in.
                Hackers find these bugs in several ways. First of all,
                the source code for a lot of services is available on the
                net. Hackers routinely look through this code searching
                for programs that have buffer overflow problems.
                Secondly, hackers may look at the programs themselves to
                see if such a problem exists, though reading assembly
                output is really difficult. Thirdly, hackers will examine
                every place the program has input and try to overflow it
                with random data. If the program crashes, there is a good
                chance that carefully constructed input will allow the
                hacker to break in. Note that this problem is common in
                programs written in C/C++, but rare in programs written
                in Java.
                
                Unexpected combinations: Programs are usually constructed
                using many layers of code, including the underlying
                operating system as the bottom most layer. Intruders can
                often send input that is meaningless to one layer, but
                meaningful to another layer. The most common language for
                processing user input on the web is PERL. Programs
                written in PERL will usually send this input to other
                programs for further evaluation. A common hacking
                technique would be to enter something like "| mail <
                /etc/passwd". This gets executed because PERL asks the
                operating system to launch an additional program with
                that input. However, the operating system intercepts the
                pipe '|' character and launches the 'mail' program as
                well, which causes the password file to be emailed to the
                intruder.
                
                Unhandled input: Most programs are written to handle
                valid input. Most programmers do not consider what
                happens when somebody enters input that doesn't match the
                specification.
                
                Race conditions: Most systems today are
                "multitasking/multithreaded". This means that they can
                execute more than one program at a time. There is a
                danger if two programs need to access the same data at
                the same time. Imagine two programs, A and B, who need to
                modify the same file. In order to modify a file, each
                program must first read the file into memory, change the
                contents in memory, then copy the memory back out into
                the file. The race condition occurs when program A reads
                the file into memory, then makes the change. However,
                before A gets to write the file, program B steps in and
                does the full read/modify/write on the file. Now program
                A writes its copy back out to the file. Since program A
                started with a copy before B made its changes, all of B's
                changes will be lost. Since you need to get the sequence
                of events in just the right order, race conditions are
                very rare. Intruders usually have to tries thousands of
                time before they get it right, and hack into the system.
                
  1.4.2 System configuration
  
                System configuration bugs can be classified in the
                following manner:
                
                Default configurations: Most systems are shipped to
                customers with default, easy-to-use configurations.
                Unfortunately, "easy-to-use" means "easy-to-break-in".
                Almost any UNIX or WinNT machine shipped to you can be
                hacked in easily.
                
                Lazy administrators: A surprising number of machines are
                configured with an empty root/administrator password.
                This is because the administrator is too lazy to
                configure one right now and wants to get the machine up
                and running quickly with minimal fuss. Unfortunately,
                they never get around to fixing the password later,
                allowing intruders easy access. One of the first things a
                intruder will do on a network is to scan all machines for
                empty passwords.
                
                Hole creation: Virtually all programs can be configured
                to run in a non-secure mode. Sometimes administrators
                will inadvertently open a hole on a machine. Most
                administration guides will suggest that administrators
                turn off everything that doesn't absolutely positively
                need to run on a machine in order to avoid accidental
                holes. Note that security auditing packages can usually
                find these holes and notify the administrator.
                
                Trust relationships: Intruders often "island hop" through
                the network exploiting trust relationships. A network of
                machines trusting each other is only as secure as its
                weakest link.
                
  1.4.3 Password cracking
  
                This is a special category all to itself.
                
                Really weak passwords: Most people use the names of
                themselves, their children, spouse/SO, pet, or car model
                as their password. Then there are the users who choose
                "password" or simply nothing. This gives a list of less
                than 30 possibilities that a intruder can type in for
                themselves.
                
                Dictionary attacks: Failing the above attack, the
                intruder can next try a "dictionary attack". In this
                attack, the intruder will use a program that will try
                every possible word in the dictionary. Dictionary attacks
                can be done either by repeatedly logging into systems, or
                by collecting encrypted passwords and attempting to find
                a match by similarly encrypting all the passwords in the
                dictionary. Intruders usually have a copy of the English
                dictionary as well as foreign language dictionaries for
                this purpose. They all use additional dictionary-like
                databases, such as names (see above) and lists of common
                passwords.
                
                Brute force attacks: Similar to a Dictionary attack, a
                intruder may try all possible combinations of characters.
                A short 4-letter password consisting of lower-case
                letters can be cracked in just a few minutes (roughly,
                half a million possible combinations). A long 7-character
                password consisting of upper and lower case, as well as
                numbers and punctuation (10 trillion combinations) can
                take months to crack assuming you can try a million
                combinations a second (in practice, a thousand
                combinations per second is more likely for a single
                machine).
                
  1.4.4 Sniffing unsecured traffic
  
                Shared medium: On traditional Ethernet, all you have to
                do is put a Sniffer on the wire to see all the traffic on
                a segment. This is getting more difficult now that most
                corporations are transitioning to switched Ethernet.
                
                Server sniffing: However, on switched networks, if you
                can install a sniffing program on a server (especially
                one acting as a router), you can probably use that
                information to break into client machines and trusted
                machines as well. For example, you might not know a
                user's password, but sniffing a Telnet session when they
                log in will give you that password.
                
                Remote sniffing: A large number of boxes come with RMON
                enabled and public community strings. While the bandwidth
                is really low (you can't sniff all the traffic), it
                presents interesting possibilities.
                
1.5 How do intruders get passwords?

          Intruders get passwords in the following ways:
          Clear-text sniffing: A number of protocols (Telnet, FTP, HTTP
          Basic) use clear-text passwords, meaning that they are not
          encrypted as the go over the wire between the client and the
          server. A intruder with a protocol analyzer can watch the wire
          looking for such passwords. No further effort is needed; the
          intruder can start immediately using those passwords to log in.
          Encrypted sniffing: Most protocols, however, use some sort of
          encryption on the passwords. In these cases, the intruder will
          need to carry out a Dictionary or Brute Force attack on the
          password in order to attempt decryption. Note that you still
          don't know about the intruder's presence, as he/she has been
          completely passive and has not transmitted anything on the
          wire. Password cracking does not require anything to be sent on
          the wire as intruder's own machine is being used to
          authenticate your password.
          Replay attack: In some cases, intruders do not need to decrypt
          the password. They can use the encrypted form instead in order
          to login to systems. This usually requires reprogramming their
          client software in order to make use of the encrypted password.
          Password file stealing: The entire user database is usually
          stored in a single file on the disk. In UNIX, this file is
          /etc/passwd (or some mirror of that file), and under WinNT,
          this is the SAM file. Either way, once a intruder gets hold of
          this file, he/she can run cracking programs (described above)
          in order to find some weak passwords within the file.
          Observation: One of the traditional problems in password
          security is that passwords must be long and difficult to guess
          (in order to make Dictionary and Brute Force cracks
          unreasonably difficult). However, such passwords are often
          difficult to remember, so users write them down somewhere.
          Intruders can often search a persons work site in order to find
          passwords written on little pieces of paper (usually under the
          keyboard). Intruders can also train themselves to watch typed
          in passwords behind a user's back.
          Social Engineering: A common (successful) technique is to
          simply call the user and say "Hi, this is Bob from MIS. We're
          trying to track down some problems on the network and they
          appear to be coming from your machine. What password are you
          using?" Many users will give up their password in this
          situation. (Most corporations have a policy where they tell
          users to never give out their password, even to their own MIS
          departments, but this technique is still successful. One easy
          way around this is for MIS to call the new employee 6-months
          have being hired and ask for their password, then criticize
          them for giving it to them in a manner they will not forget :-)
   
1.6 What is a typical intrusion scenario?

          A typical scenario might be:
          Step 1: outside reconnaissance The intruder will find out as
          much as possible without actually giving themselves away. They
          will do this by finding public information or appearing as a
          normal user. In this stage, you really can't detect them. The
          intruder will do a 'whois' lookup to find as much information
          as possible about your network as registered along with your
          Domain Name (such as foobar.com. The intruder might walk
          through your DNS tables (using 'nslookup', 'dig', or other
          utilities to do domain transfers) to find the names of your
          machines. The intruder will browse other public information,
          such as your public web sites and anonymous FTP sites. The
          intruder might search news articles and press releases about
          your company.
          Step 2: inside reconnaisance The intruder uses more invasive
          techniques to scan for information, but still doesn't do
          anything harmful. They might walk through all your web pages
          and look for CGI scripts (CGI scripts are often easily hacked).
          They might do a 'ping' sweep in order to see which machines are
          alive. They might do a UDP/TCP scan/strobe on target machines
          in order to see what services are available. They'll run
          utilities like 'rcpinfo', 'showmount', 'snmpwalk', etc. in
          order to see what's available. At this point, the intruder has
          done 'normal' activity on the network and has not done anything
          that can be classified as an intrusion. At this point, a NIDS
          will be able to tell you that "somebody is checking door
          handles", but nobody has actually tried to open a door yet.
          Step 3: exploit The intruder crosses the line and starts
          exploiting possible holes in the target machines. The intruder
          may attempt to compromise a CGI script by sending shell
          commands in input fields. The intruder might attempt to exploit
          well-known buffer-overrun holes by sending large amounts of
          data. The intruder may start checking for login accounts with
          easily guessable (or empty) passwords. The hacker may go
          through several stages of exploits. For example, if the hacker
          was able to access a user account, they will now attempt
          further exploits in order to get root/admin access.
          Step 4: foot hold At this stage, the hacker has successfully
          gained a foot hold in your network by hacking into a machine.
          The intruder's main goal is to hide evidence of the attacks
          (doctoring the audit trail and log files) and make sure they
          can get back in again. They may install 'toolkits' that give
          them access, replace existing services with their own Trojan
          horses that have backdoor passwords, or create their own user
          accounts. System Integrity Verifiers (SIVs) can often detect an
          intruder at this point by noting the changed system files. The
          hacker will then use the system as a stepping stone to other
          systems, since most networks have fewer defenses from inside
          attacks.
          Step 5: profit The intruder takes advantage of their status to
          steal confidential data, misuse system resources (i.e. stage
          attacks at other sites from your site), or deface web pages.
          Another scenario starts differently. Rather than attack a
          specific site, and intruder might simply scan random internet
          addresses looking for a specific hole. For example, an intruder
          may attempt to scan the entire Internet for machines that have
          the SendMail DEBUG hole. They simply exploit such machines that
          they find. They don't target you directly, and they really
          won't even know who you are. (This is known as a 'birthday
          attack'; given a list of well-known security holes and a list
          of IP addresses, there is a good chance that there exists some
          machine somewhere that has one of those holes).
   
1.7 What are some common "intrusion signatures"?

          There are three types of attacks:
          reconnaisance These include ping sweeps, DNS zone transfers,
          e-mail recons, TCP or UDP port scans, and possibly indexing of
          public web servers to find cgi holes.
          exploits Intruders will take advantage of hidden features or
          bugs to gain access to the system.
          denial-of-service (DoS) attacks Where the intruder attempts to
          crash a service (or the machine), overload network links,
          overloaded the CPU, or fill up the disk. The intruder is not
          trying to gain information, but to simply act as a vandal to
          prevent you from making use of your machine.
   
1.8 What are some common exploits?

  1.8.1 CGI scripts
  
                CGI programs are notoriously insecure. Typical security
                holes include passing tainted input directly to the
                command shell via the use of shell metacharacters, using
                hidden variables specifying any filename on the system,
                and otherwise revealing more about the system than is
                good. The most well-known CGI bug is the 'phf' library
                shipped with NCSA httpd. The 'phf' library is supposed to
                allow server-parsed HTML, but can be exploited to give
                back any file. Other well-known CGI scripts that an
                intruder might attempt to exploit are: TextCounter,
                GuestBook, EWS, info2www, Count.cgi, handler,
                webdist.cgi, php.cgi, files.pl, nph-test-cgi,
                nph-publish, AnyForm, FormMail. If you see somebody
                trying to access one or all of these CGI scripts (and you
                don't use them), then it is clear indication of an
                intrusion attempt (assuming you don't have a version
                installed that you actually want to use).
                
  1.8.2 Web server attacks
  
                Beyond the execution of CGI programs, web servers have
                other possible holes. A large number of self-written web
                servers (include IIS 1.0 and NetWare 2.x) have hole
                whereby a file name can include a series of "../" in the
                path name to move elsewhere in the file system, getting
                any file. Another common bug is buffer overflow in the
                request field or in one of the other HTTP fields.
                
                Web server often have bugs related to their interaction
                with the underlying operating system. An old hole in
                Microsoft IIS have been dealing with the fact that files
                have two names, a long filename and a short 8.3 hashed
                equivalent that could sometimes be accessed bypassing
                permissions. NTFS (the new file system) has a feature
                called "alternate data streams" that is similar to the
                Macintosh data and resource forks. You could access the
                file through its stream name by appending "::$DATA" in
                order to see a script rather than run it.
                
                Servers have long had problems with URLs. For example,
                the "death by a thousand slashes" problem in older Apache
                would cause huge CPU loads as it tried to process each
                directory in a thousand slash URL.
                
  1.8.3 Web browser attacks
  
                It seems that all of Microsoft's and Netscape's web
                browsers have security holes (though, of course, the
                latest ones never have any that we know about -- yet).
                This includes both URL, HTTP, HTML, JavaScript, Frames,
                Java, and ActiveX attacks.
                
                URL fields can cause a buffer overflow condition, either
                as it is parsed in the HTTP header, as it is displayed on
                the screen, or processed in some form (such as saved in
                the cache history). Also, an old bug with Internet
                Explorer allowed interaction with a bug whereby the
                browser would execute .LNK or .URL commands.
                
                HTTP headers can be used to exploit bugs because some
                fields are passed to functions that expect only certain
                information.
                
                HTML can be often exploited, such as the MIME-type
                overflow in Netscape Communicator's <EMBED> command.
                
                JavaScript is a perennial favorite, and usually tries to
                exploit the "file upload" function by generating a
                filename and automatically hidden the "SUBMIT" button.
                There have been many variations of this bug fixed, then
                new ways found to circumvent the fixes.
                
                Frames are often used as part of a JavaScript or Java
                hack (for example, hiding web-pages in 1px by 1px sized
                screens), but they present special problems. For example,
                I can include a link to a trustworthy site that uses
                frames, then replace some of those frames with web pages
                from my own site, and they will appear to you to be part
                of that remote site.
                
                Java has a robust security model, but that model has
                proven to have the occasional bug (though compared to
                everything else, it has proven to be one of the most
                secure elements of the whole system). Moreover, its
                robust security may be its undoing: Normal Java applets
                have no access to the local system, but sometimes they
                would be more useful if they did have local access. Thus,
                the implementation of "trust" models that can more easily
                be hacked.
                
                ActiveX is even more dangerous than Java as it works
                purely from a trust model and runs native code. You can
                even inadvertently catch a virus that was accidentally
                imbedded in some vendor's code.
                
  1.8.4 SMTP (SendMail) attacks
  
                SendMail is an extremely complicated and widely used
                program, and as a consequence, has been the frequent
                source of security holes. In the old days (of the '88
                Morris Worm), hackers would take advantage of a hole in
                the DEBUG command or the hidden WIZ feature to break into
                SMTP. These days, they often try buffer overruns. SMTP
                also can be exploited in reconnaissance attacks, such as
                using the VRFY command to find user names.
                
  1.8.5 Access
  
                Failed login attempts, failed file access attempts,
                password cracking, administrative powers abuse
                
  1.8.6 IMAP
  
                Users retrieve e-mail from servers via the IMAP protocol
                (in contrast, SMTP transfers e-mail between servers).
                Hackers have found a number of bugs in several popular
                IMAP servers.
                
  1.8.7 IP spoofing
  
                There is a range of attacks that take advantage of the
                ability to forge (or 'spoof') your IP address. While a
                source address is sent along with every IP packet, it
                isn't actually used for routing. This means an intruder
                can pretend to be you when talking to a server. The
                intruder never sees the response packets (although your
                machine does, but throws them away because they don't
                match any requests you've sent). The intruder won't get
                data back this way, but can still send commands to the
                server pretending to be you.
                
                IP spoofing is frequently used as part of other attacks:
                
              SMURF
                      Where the source address of a broadcast ping is
                      forged so that a huge number of machines respond
                      back to victim indicated by the address,
                      overloading it (or its link).
                      
              TCP sequence number prediction
                      In the startup of a TCP connection, you must choose
                      a sequence number for your end, and the server must
                      choose a sequence number for its end. Older TCP
                      stacks choose predictable sequence numbers,
                      allowing intruders to create TCP connections from a
                      forged IP address (for which they will never see
                      the response packets) that presumably will bypass
                      security.
                      
              DNS poisoning through sequence prediction
                      DNS servers will "recursively" resolve DNS names.
                      Thus, the DNS server that satisfies a client
                      request will become itself a client to the next
                      server in the recursive chain. The sequence numbers
                      it uses are predictable. Thus, an intruder can send
                      a request to the DNS server and a response to the
                      server forged to be from the next server in the
                      chain. It will then believe the forged response,
                      and use that to satisfy other clients.
                      
  1.8.8 Buffer Overflows
  
                Some other buffer overflow attacks are:
                
              DNS overflow
                      Where an overly long DNS name is sent to a server.
                      DNS names are limited to 64-bytes per subcomponent
                      and 256-bytes overall.
                      
              statd overflow
                      where an overly long filename is provided
                      
  1.8.9 DNS attacks
  
                DNS is a prime target because if you can corrupt the DNS
                server, you can take advantage of trust relationships.
                
              DNS cache poisoning
                      Every DNS packet contains a "Question" section and
                      "Answer" section. Vulnerable servers will believe
                      (and cache) Answers that you send along with
                      Questions. Most, but not all, DNS servers have been
                      patched as of November, 1998.
                      
              DNS poisoning through sequence prediction
                      See above
                      
              DNS overflow
                      See above
                      
1.9 What are some common reconnaisance scans?

  1.9.1 Ping sweeps
  
                This simple scan simply pings a range of IP addresses to
                find which machines are alive. Note that more
                sophisticated scanners will use other protocols (such as
                an SNMP sweep) to do the same thing.
                
  1.9.2 TCP scans
  
                Probes for open (listening) TCP ports looking for
                services the intruder can exploit. Scans can use normal
                TCP connections or stealth scans that use half-open
                connections (to prevent them from being logged) or FIN
                scans (never opens a port, but tests if someone's
                listening). Scans can be either sequential, randomized,
                or configured lists of ports.
                
  1.9.3 UDP scans
  
                These scans are a little bit more difficult because UDP
                is a connectionless protocol. The technique is to send a
                garbage UDP packet to the desired port. Most machines
                will respond with an ICMP "destination port unreachable"
                message, indicating that no service is listening at that
                port. However, many machines throttle ICMP messages, so
                you can't do this very fast.
                
  1.9.4 OS identification
  
                By sending illegal (or strange) ICMP or TCP packets, an
                intruder can identify the operating system. Standards
                usually state how machines should respond to legal
                packets, so machines tend to be uniform in their response
                to valid input. However, standards omit (usually
                intentionally) the response to invalid input. Thus, each
                operating system's unique responses to invalid inputs
                forms a signature that hackers can use to figure out what
                the target machine is. This type of activity occurs at a
                low level (like stealth TCP scans) that systems do not
                log.
                
1.10 What are some common DoS (Denial of Service) attacks?

  1.10.1 Ping-of-Death
  
                Sends an invalid fragment, which starts before the end of
                packet, but extends past the end of the packet.
                
  1.10.2 SYN Flood
  
                Sends TCP SYN packet (which start connections) very fast,
                leaving the victim waiting to complete a huge number of
                connections, causing it to run out of resources and
                dropping legitimate connections. A new defense against
                this are "SYN cookies". Each side of a connection has its
                own sequence-number. In response to a SYN, the attacked
                machine creates a special sequence number that is a
                "cookie" of the connection then forgets everything it
                knows about the connection. It can then recreate the
                forgotten information about the connection when the next
                packets come in from a legitimate connection.
                
  1.10.3 Land/Latierra
  
                Sends forged SYN packet with identical source/destination
                address/port so that system goes into infinite loop
                trying to complete the TCP connection.
                
  1.10.4 WinNuke
  
                Sends OOB/URG data on a TCP connection to port 139
                (NetBIOS Session/SMB), which cause the Windows system to
                hang.
                
1.11 How much danger from intrusions is there?

          I frequently hear from people the statement "There's nothing on
          the system that anybody would want anyway". I walk them through
          various scenarios, such as simple ones if they've ever paid for
          anything on-line with a credit card or if they have any
          financial records or social security number on their personal
          machine.
          More importantly, there is the issue of legal liability. You
          are potentially liable for damages caused by a hacker using
          your machine. You must be able to prove to a court that you
          took "reasonable" measures to defend yourself from hackers. For
          example, consider if you put a machine on a fast link (cable
          modem or DSL) and left administrator/root accounts open with no
          password. Then if a hacker breaks into that machine, then uses
          that machine to break into a bank, you may be held liable
          because you did not take the most obvious measures in securing
          the machine.
          There is a good paper
          http://www.cert.org/research/JHThesis/Start.html by John D.
          Howard that discusses how much hacking goes on over the
          Internet, and how much danger you are in.
   
                                2. Architecture
                                       
2.1 How are intrusions detected?

          There are two basic ways intrusions are detected.
          Signature recognition is the most common technique, where
          incoming/outgoing traffic is compared against well-known
          'signatures'. For example, a large number of failed TCP
          connections to a wide variety of ports indicate somebody is
          doing a TCP port scan.
          Anomaly detection uses statistical analysis to find changes
          from baseline behavior (such as a sudden increase in traffic,
          CPU utilization, disk activity, user logons, file accesses,
          etc.). This technique is weaker than signature recognition, but
          has the benefit that can catch attacks for which no signature
          exists. Anomaly detection is mostly a theoretical at this point
          and is the topic of extensive research (nobody gets a Ph.D. by
          simply cataloguing signatures, so researchers have to employ
          neural networks, fuzzy logic, or other AI techniques).
          Note that detection can be "real-time" as they happen, or in an
          off-line manner, such as reading old log files.
   
2.2 How does a NIDS match signatures with incoming traffic?

          Traffic consists of IP datagrams flowing across a network. A
          NIDS is able to capture those packets as they flow by on the
          wire. A NIDS consists of a special TCP/IP stack that
          reassembles IP datagrams and TCP streams. It then applies some
          of the following techniques:
          Protocol stack verification A number of intrusions, such as
          "Ping-O-Death" and "TCP Stealth Scanning" use violations of the
          underlying IP, TCP, UDP, and ICMP protocols in order to attack
          the machine. A simple verification system can flag invalid
          packets. This can include valid, by suspicious, behavior such
          as severally fragmented IP packets.
          Application protocol verification A number of intrusions use
          invalid protocol behavior, such as "WinNuke", which uses
          invalid NetBIOS protocol (adding OOB data) or DNS cache
          poisoning, which has a valid, but unusually signature. In order
          to effectively detect these intrusions, a NIDS must
          re-implement a wide variety of application-layer protocols in
          order to detect suspicious or invalid behavior.
          Creating new loggable events A NIDS can be used to extend the
          auditing capabilities of your network management software. For
          example, a NIDS can simply log all the application layer
          protocols used on a machine. Downstream event log systems
          (WinNT Event, UNIX syslog, SNMP TRAPS, etc.) can then correlate
          these extended events with other events on the network.
   
2.3 What are the limitations of network intrusion detection systems?

          Consider the following limitations:
          Address spoofing/proxying: One goal of intrusion detection is
          to point fingers at who is attacking you. This can be difficult
          for a number of reasons. In 'Smurf' attack, for example, you
          receive thousands of replies from a packet that you never sent.
          The NIDS and detect those replies, but cannot discover who sent
          the forged packet. In TCP Sequence Number Prediction, forged IP
          addresses are used so that the NIDS does not know precisely
          where the intruder is coming from. Finally, most intruders will
          'bounce' their attacks via FTP or Web proxies, or stage their
          attacks from other sites they have broken into. Thus, it will
          be very difficult to find out who is attacking your site, and
          configuring IP address filters in your firewall won't help.
          Resource limitation: NIDS suffer from the fact that it can take
          extensive resources to keep up with hackers. Most NIDS
          reassemble TCP streams, but few reassemble packets (because of
          the memory and CPU resources required). Intruders who fragment
          their packets can often go undetected. Similarly, intruders can
          spend months slowly probing a network. Again, NIDS do not have
          the resources to keep logs around that long in order to
          correlate events as being an intrusion. Finally, while
          promiscuous devices can keep up with T-1 connections with the
          Internet, they have a much more difficult time with 100-mbps or
          gigabyte backbones.
   
2.4 What happens after a NIDS detects an attack?

        Reconfigure firewall
                Configure the firewall to filter out the IP address of
                the intruder. However, this still allows the intruder to
                attack from other addresses. Checkpoint firewall's
                support a "Suspicious Activity Monitoring Protocol
                (SAMP)" for configuring their firewalls.
                
        chime
                Beep or play a .WAV file. For example, you might hear a
                recording "You are under attack".
                
        SNMP Trap
                Send an SNMP Trap datagram to a management console like
                HP OpenView, Tivoli, Cabletron Spectrum, etc.
                
        NT Event
                Send an event to the WinNT event log.
                
        syslog
                Send an event to the UNIX syslog event system.
                
        send e-mail
                Send e-mail to an administrator to notify of the attack.
                
        page
                Page (using normal pagers) the system administrator.
                
        Log the attack
                Save the attack information (timestamp, intruder IP
                address, victim IP address/port, protocol information).
                
        Save evidence
                Save a tracefile of the raw packets for later analysis.
                
        Launch program
                Launch a separate program to handle the event.
                
        Terminate the TCP session
                Forge a TCP FIN packet to force a connection to
                terminate.
                
        Reconfigure Firewall
                Checkpoint has their "OPSEC" standard for re-configuring
                firewalls to block the offending IP address.
                
2.5 What other countermeasures besides IDS are there?

        Firewalls
                Most people think of the firewall as their first line of
                defense. This means if intruders figure out how to bypass
                it (easy, especially since most intrusions are committed
                by employees inside the firewall), they will have free
                run of the network. A better approach is to think of it
                as the last line of defense: you should be pretty sure
                machines are configured right and intrusion detection is
                operating, and then place the firewall up just to avoid
                the wannabe script-kiddies. Note that almost any router
                these days can be configured with some firewall
                filtering.
                
        authentication
                You should run scanners that automated the finding of
                open accounts. You should enforce automatically strict
                policies for passwords (7 character minimum, including
                numbers, dual-case, and punctuation) using crack or built
                in policy checkers (WinNT native, add-on for UNIX). You
                can also consider single-sign on products and integrating
                as many password systems as you can, such as
                RADIUS/TACACS integration with UNIX or NT (for dial-up
                style login), integrating UNIX and WinNT authentication
                (with existing tools are the new Kerberos in Windows
                2000). These authentication systems will help you also
                remove "clear-text" passwords from protocols such as
                Telnet, FTP, IMAP, POP, etc.
                
        VPNs (Virtual Private Networks)
                VPNs create a secure connection over the Internet. There
                are many technologies that can be used. PPTP creates an
                encrypted PPP connection over TCP (meaning, you have two
                IP addresses, one for your Internet connection, and one
                for the virtual private connection). The new IPsec add
                enhancements to the traditional IP protocol.
                
        encryption
                Encryption is becoming increasingly popular. You have
                your choice of e-mail encryption, file encryption, or
                file system encryption (which is the best).
                
2.6 Where do I put IDS systems on my network?

        network perimeter
                IDS is most effective on the network perimeter, such as
                on both sides of the firewall, near the dial-up server,
                and on links to partner networks. These links tend to be
                low-bandwidth (T1 speeds) such that an IDS can keep up
                with the traffic.
                
        WAN backbone
                Another high-value point is the corporate WAN backbone. A
                frequent problem is hacking from "outlying" areas to the
                main corporate network. Since WAN links tend to be low
                bandwidth, IDS systems can keep up.
                
        server farms
                Serves are often placed on their own network, connected
                to switches. The problem these servers have, though, is
                that IDS systems cannot keep up with high-volume traffic.
                For extremely important servers, you may be able to
                install dedicate IDS systems that monitor just the
                individual server's link. Also, application servers tend
                to have lower traffic than file servers, so they are
                better targets for IDS systems.
                
        LAN backbones
                IDS systems are impractical for LAN backbones, because of
                their high traffic requirements. Some vendors are
                incorporating IDS detection into switches. A full IDS
                system that must reassemble packets is unlikely to keep
                up. A scaled-down system that detects simpler attacks but
                can keep up is likely to be a better choice.
                
                                   3. Policy
                                       
3.1 How do I increase intrusion detection/prevention under WinNT?

          The following lists items that make WinNT more secure,
          including detection as well as prevention. These are roughly
          listed in order of importance.
         1. Install the latest service packs and "hot fixes". These are
            listed at http://www.microsoft.com/security/. If you are
            using WinNT 4.0 and you don't have Service Pack #3 (SP3)
            installed, an intruder can break into your system.
         2. INSTALLATION: Use NTFS instead of FAT. NTFS allows
            permissions to be set on a per-file/per-directory basis. NTFS
            also allows auditing on a per-file/per-directory basis. Note
            that many people recommend using FAT as the boot drive and
            NTFS for all other drives (due to the ease-of-use in using
            DOS to fix things on a FAT drive). However, using NTFS for
            all drives is definitely more secure.
         3. USRMGR: Rename the "administrator" account. A common attack
            is to use a Dictionary or brute force attack on the
            "administrator" account. Normal accounts can be configured to
            automatically (and temporarily) "lock out" after a few failed
            password attempts. However, this feature isn't possible for
            the administrator account because this allows a denial of
            service attack (i.e. prevent administration of the machine by
            locking out the administrator account).
         4. USRMGR: Create a new account named "administrator" for
            detecting intrusion attempts.
         5. USRMGR: Disable the "guest" account. You may also want to
            rename this account as (much like "administrator"). Once
            you've renamed the "guest" account, you may want to create a
            new account named "guest" for detecting hacking attempts.
         6. NTFS: Disable "write" access for "Everyone" on the
            %systemroot%/system32 directory.
         7. REGEDT32: Turn on auditing for "HKEY_LOCAL_MACHINE\Security"
            in order to detect remote registry browsing.
         8. INSTALLATION: Do not install in "C:\WINNT" directory.
            Sometimes intruders will be able to access files if they know
            the filename; installing in some other directory prevents a
            priori knowledge. Better yet, install in C:\WINNT, then
            reinstall in some other directory, then turn auditing on
            within that directory to alert you to people accessing those
            older files.
         9. INSTALLATION: Use the boot partition only for booting and for
            system files. Put data and applications on a separate
            partition. It is also a good idea to separate applications
            from data.
        10. CONTROLPANEL: Enable "Password Protected" on the screensaver.
            The best screensaver is "Blank Screen". You would think that
            screensavers run at idle priority, but this isn't always the
            case, so you can increase the performance of your server by
            using "Blank Screen". Also, this will reduce power
            consumption in monitors, especially those that can detect a
            blank screen and turn themselves off. Finally, some
            screensavers (i.e. PointCast) are probably hackable.
        11. REGEDT32: Turn of automatic sharing of ADMIN$, C$, D$, etc.
            via the "AutoShare" parameter in the registry. This parameter
            is under
            "HKEY_LOCAL_MACHINE\System\CurrentControlSet\Services\LanmanS
            erver\Parameters", and is "AutoShareServer" for WinNT Server
            or "AutoShareWks" for WinNT Workstation. This is a DWORD,
            with a value of '1' for enabled (default), or a value of '0'
            for disabled. You will have to add the value yourself because
            it doesn't already exist in the registry.
        12. REGEDT32: Turn of account/share information via anonymous
            access. Add "RestrictAnonymous" DWORD with a value of "1" to
            the registry key
            "HKEY_LOCAL_MACHINE\SYSTEM\CurrentControlSet\Control\LSA"
            Note that if you see an error "Could not find domain
            controller for this domain." while setting domain trust
            relationships, you may have to change it back.
        13. USRMGR: If you are using Domains (rather than Workgroups),
            change the user right "Access this computer from the network"
            to "Authenticated Users" rather than "Everyone". This
            disables remote access via local accounts on your machine,
            and allows only access through domain accounts.
        14. PASSPROP: Enable lockout of the "administrator" account for
            remote access. This enables the situation where the remote
            intruder fails to guess the correct password after three
            tries. After lock-out, the administrator can only log in
            locally at the system console. You can also disable remote
            administrator access completely in USRMGR by removing the
            right "Access this computer from the network" from
            "Administrators", but this disables all remote
            administration, which make administration too difficult in a
            large WinNT environment.
          Also consider physical intrusion prevention network wide. John
          Kozubik suggests using login scripts to force the built-in
          password protected screen-saver. In the login script, include
          the line like:
regedit /s \\MY_PDC\netlogon\scrn.reg
          And in the file "scrn.reg", put the text:
REGEDIT4
[HKEY_CURRENT_USER\Control Panel\Desktop]
"ScreenSaveTimeOut"="1800"
"ScreenSaveActive"="1"
"SCRNSAVE.EXE"="c:\winnt\system32\logon.scr"
"ScreenSaverIsSecure"="1"
          This will trigger the password prompt to appear 30-minutes
          after a user is away from the desktop (it doesn't log them out;
          just forces them to re-enter the password before they have
          access again).
   
3.2 How do I increase intrusion detection/prevention under Win95/Win98?

          This section assumes you are a home user using Win95/Win98 to
          access the Internet. Win95/Win98 has no auditing or logging
          capabilities; you really should upgrade to WinNT if you are
          using the system for any serious purpose.
          The following are techniques for the typical user:
         1. Install the latest patches (of course).
         2. Turn off print sharing. When print sharing is turned on, the
            system creates a PRINTER$ share that allows remote systems to
            access printer drivers from the local system32 directory.
            Unfortunately, this allows remote systems to access
            non-driver files, such as the Win95 password file (combined
            with other Win95 bugs).
         3. Turn off file sharing. As a home user, you probably don't
            need it. If you must share files, make sure that you choose a
            strong password, and only turn it on for brief moments while
            you need to share the files, then turn it off again.
         4. (more forthcoming)
          John Kozubik suggests the following techniques for corporate
          users (who presumably run login scripts from the servers).
          Since Win95/Win98 is so vulnerable, they provide easy
          penetration to the rest of the corporate environment. Win95
          caches passwords in easy-to-read formats, so you want to remove
          them.
          
        del c:\windows\*.pwl
                The password cache file will be the first one intruders
                look for. It has the same name as the user name, and
                poorly encrypts the cached passwords. Beware that this
                deletes dial-up passwords as well, so users that bring
                their notebooks into work and connect to the network will
                find their home dial-up passwords deleted.
                
        Disable internal caching of passwords
                Run:
                
REGEDIT /s \\MY_PDC\netlogon\nocache.reg

                where "nocache.reg" consists of:
                
REGEDIT4
[HKEY_LOCAL_MACHINE\SOFTWARE\Microsoft\Windows\CurrentVersion\Policies\Network]
"DisablePwdCaching"=dword:00000001

3.3 How do I increase intrusion detection/prevention under UNIX?

         1. Do not install more services than you need. I installed
            everything on my RedHat Linux distribution and the machine
            lights up like a Xmas tree when port scanned. I already know
            of a few holes on that (test) machine that I can use to break
            in.
         2. Use 'netstat' or a TCP/UDP scanner and 'rpcinfo' to list all
            services on your machine. Again, make sure that everything
            you don't explicitly understand is turned off.
         3. (more forthcoming; frankly, I've been more of an WinNT admin
            lately so my skills are getting rusty)
         4. Read
            ftp://ftp.auscert.org.au/pub/auscert/papers/unix_security_ch
            ecklist.
   
3.4 How do I increase intrusion detection/prevention under Macintosh?

          Macintoshes are 'end-user' systems, and support few services
          that can be hacked. In comparison, Windows machines are more
          numerous, and UNIX machines have a lot more interesting
          (hackable) services running on them. Thus, Macintoshes are
          frequently not the target of intruders.
          Beyond that, I know of nothing in particular.
   
3.5 How do I increase intrusion detection/prevention for the enterprise?

          First and foremost, create a security policy. Let's say that
          you are watching the network late in the evening and you see an
          intrusion in-progress. What do you do? Do you let the intrusion
          progress and collect evidence? Do you pull the plug? If so, do
          you pull the plug on the firewall between the intra- and extra-
          net? Or do you take down the entire Internet connection
          (preventing users from getting to you web site)? Who has the
          authority to pull the plug?
          The priorities need to be set in place by the CEO of the
          corporation. Let's consider the scenario where you think you
          are being attacked, so you pull the plug. The users get up in
          arms, and complain. And, as it turns out, you were wrong, so
          your but gets fried. Even when blatant attacks are going on,
          few people pull the plug for fear of just such repercussions.
          Data theft is theoretical; ticked-off users are very real.
          Therefore, you need a policy from the very top that clearly
          states the importance of things and clearly lays out a
          procedure for what happens when an intrusion is suspected.
          [Author: does anybody have sample policies they can send me?]
          Once you have the priorities straight, you need to figure out
          the technology. That's described in the next section.
   
3.6 How should I implement intrusion detection my enterprise?

          Think about how you can configure the following systems in
          order to detect intruders:
         1. Operating Systems such as WinNT and UNIX come with integrated
            logging/auditing features that can be used to monitor
            security critical resources. A section below discusses how to
            configure Windows and UNIX in order to enable intrusion
            detection.
         2. Services, such as web servers, e-mail servers, and databases,
            include logging/auditing features as well. In addition, there
            are many tools that can be used to parse these files in order
            to discover intrusion signatures.
         3. Network Intrusion Detection Systems that watch network
            traffic in an attempt to discover intrusion attempts. A
            section below lists a number of these products.
         4. Firewalls usually have some network intrusion detection
            capabilities. After all, blocking intrusions is their primary
            purpose; it would be foolish not to detect intrusions as
            well.
         5. Network management platforms (such as OpenView) have tools to
            help network managers set alerts on suspicious activity. At
            minimum, all SNMP devices should send "Authentication
            Failure" traps and management consoles should alert
            administrators when these go off.
   
3.7 What should I do when I've been hacked?

          Read CERT's intruder detection checklist at
          ftp://ftp.cert.org/pub/tech_tips/intruder_detection_checklist.
          For the most part, a good response requires that you've set up
          good defensive measures in the first place. These include:
          + Set up an "incident response team". Identify those people who
            should be called whenever people suspect an intrusion in
            progress.
          + Figure out guidelines now for the response action. For
            example, you need to decide now what your priorities are
            between network uptime and intrusion: can you pull the
            network plug whenever you strongly suspect intrusion? Do you
            want to allow continued intrusion in order to gather evidence
            against the intruder? Decide now, and get the CEO's approval
            now, because you want have time during the attack.
          + Figure out guidelines for communication. Do you propagate the
            information up the corporate food chain from your boss up to
            the CEO, or horizontally to other business units? Do you take
            part in incident reporting organizations such as FIRST (Forum
            of Incident Response and Security Teams) at
            http://www.first.org? Do you inform the FBI or police? Do
            you notify partners (vendors/customers) that have a
            connection to your network (and who may be compromised, or
            from whom the attack originated)? Do you hide the intrusion
            from the press?
          + Set up your logging/auditing/monitoring procedures now; one
            of the most common thoughts after an attack is how much they
            wished they had adequate logging in the first place in order
            to figure out what happened.
          + Get training on all these issues.
          Since computer networks are growing so fast, there are not
          enough trained people to handle intrusions. Likewise, networks
          grow in an ad hoc fashion, so logging/auditing is haphazard.
          These conditions lead to the state that people don't know what
          to do when they've been attacked, and their networks aren't
          robust enough to recover well from the attack.
   
3.8 How should I respond when somebody tells me they've been hacked from my
site?

          On the IDS mailing list, someone asked how they should respond
          to the following e-mail:
Below is a log showing a telnet connection from a machine within your
domain.  The machine it connected to does not offer this service publicly so
this can only be assumed to be an IP space probe for vulnerable machines.
We take this matter seriously, and hope that you will as well. Please take
action on this issue as is appropriate and respond to this address with your
 actions.
Nov  6 07:13:13 pbreton in.telnetd[31565]: refused connect from  xx.xx.xx.xx
          This log entry was likely generated by tcpwrappers, a facility
          that enhances logging and access control to services on UNIX.
          It shows an unauthorized attempt from your site to the
          specified machine. As claimed in the e-mail message, it may be
          an automated sweep of some sort. The most popular protocols
          people sweep with are ICMP, FTP, SMTP, NNTP, and Telnet.
          In any case, this is evidence of a probe, not an attack.
          Furthermore, there is no other corroborating evidence. As
          pointed out by Greg Drew <gdrew at computer dot org> there
          could be a number of benign reasons:
          + Somebody typed "telnet xx.xx.xx.xx" and mistyped the IP
            address.
          + Somebody meant to type "telnet xx.xx.xx.xx 25" to connect to
            the STMP service in response to receiving spam from the site.
            The person might have forgotten the "25" or mistyped "23".
          + Somebody might have actually done a more extensive scan on
            the target machines in response to spam. I've personally done
            light scans before (finger, rusers, etc.) to track down the
            source of spam.
          + May have been an honest mistake (i.e. somebody used to have
            an account on that machine, but no longer does).
          But there are also some nefarious possibilities:
          + Your site may have already been hacked, and the hacker is
            running scans from the compromised machine.
          + One of your employees is using the machine to hack (I've
            worked at a company where this happened -- though since the
            company made protocol analyzers, it was kinda stupid and they
            were quickly detected).
          <vick at macdoon dot lerc dot nasa dot gov> pointed out another
          possibility: this might be a social engineering attack. The
          message asks (commands) you to contact them to describe what
          actions you have taken. If you do so, it will tell a lot about
          your network:
          + The target is a legal IP address (though not so interesting).
          + Your IP address (the above message was likely sent to
            "postmaster" or some such well-known address, but you will
            likely respond using your own address.
          + Your readiness level: if you come back with a lame response
            (such as "we can't take action because we have no log files")
            then they know that your network is prime hacking territory.
          + This may be "social engineering spam". The sender of the
            message may be a company looking to resell intrusion
            detection products.
          Like responding to spam, there is probably little good that can
          come about responding to this e-mail message (unless you find
          evidence that some hacker has been using your network as a
          stepping stone). It probably would be a good idea to check you
          system logs for the data/time in question, and if you don't
          have logs, now might be a good time to turn logging on.
          As it turns out, the incident was benign. The target network
          had reconfigured itself, and the "unauthorized" user didn't
          know about it yet, and wasn't logging in correctly.
   
3.9 How do I collect enough evidence about the hacker?

          An interesting field of IDS is collecting enough information
          about the incident to identify the hacker. This can be very
          hard because truely elite hackers will be bouncing their
          attacks from another compromised system. Hackers will also
          often employ IP address spoofing, which may appear as if
          attacks are coming from machines that aren't even turned on.
          As far as I can tell, the best technique is to collect as much
          information as you can. For example, I've put a sniffing device
          capturing to tracefiles on our T-1 line saving to files on a
          16-gigabyte disk (most any sniffing program on most platforms
          can do this). You may not think it fun, but I enjoy perusing
          these files. It's amazing how many TCP/UDP scans and other
          probes I see on a regular basis.
          Likewise, you should make sure you have full auditing and
          logging enabled on any/all systems exposed to the Internet.
          These will help you figure out what happened when you were
          hacked.
   
                                  4. Products
                                       
          This section discusses available products.
   
4.1 What freeware/shareware intrusion detection systems are available?

          The most complete list on the net seams to be the COAST
          Intrusion Detection System Resources page at
          http://www.cs.purdue.edu/coast/ids. Here are some that I have
          looked at:
          
  4.1.1 Network Flight Recorder (NFR)
  
                A UNIX-based packet-watcher based upon libcap/tcpdump. As
                far as I can tell, NFR comes with few intrusion detection
                signatures out-of-box, but since source code is available
                for the system, many people have created signatures for
                the system. Also, "value added resellers" provide systems
                with a better out-of-box experience. A general
                description can be found at
                http://www.nfr.net/forum/publications/LISA-97.htm
                
  4.1.1 Bro
  
                Vern Paxson's Bro intrusion detection system. Also based
                on libcap. I haven't heard of anyone actually using it.
                Read the paper
                http://ftp.ee.lbl.gov/papers/bro-usenix98-revised.ps.Z
                for more information.
                
  4.1.2 AAFID
  
                Purdue's COAST distributed agent idea. I'm not sure how
                much of this is proposals, and how much is real.
                
  4.1.3 Shadow
  
                I've lost the information I had on this product. I think
                it is a project used in the Navy to track intrusions, and
                generate reports on them. They have an interesting report
                at
                http://www.nswc.navy.mil/ISSEC/CID/co-ordinated_analysis
                .txt where they describe coordinated, slow attacks they
                have detected using this system.
                
  4.1.4 Argus
  
                Argus isn't an intrusion detection system itself.
                However, it monitors packets off the wire and generates
                logfile events. You can then process those log entries
                (or peruse them yourself) to find intrusions.
                
                See ftp://coast.cs.purdue.edu/pub/tools/unix/argus for
                more info. Also see ftp://ftp.sei.cmu.edu/pub/argus-1.5
                
  4.1.n Others
  
                NNstat??
                
4.2 What commercial intrusion detection systems are available?

          Here is a table I've culled from various sources.
          
   Vendor Product Initial version Update Frequency How Protocols
   Applications Mode Hardware OS Layer-2 Communicate with
   routers/firewalls Notification Integration
   Cisco NetRanger August 1996 About every 4 months Via CD TCP/IP SMB,
   NFS, DNS, HTTP, FTP, Telnet, SNMP, SMTP, RPC Promiscuous dual-CPU
   running Solaris x86 Solaris x86 10/100 Ethernet, FDDI, Token Ring yes
   paging, e-mail, icon change ?
   ISS RealSecure December 1996 Once per month Manually via encrypted web
   or via encrypted e-mail TCP/IP SMB, NFS, DNS, HTTP, FTP, Telnet, SNMP,
   SMTP, RPC Promiscuous many NT and UNIX 10/100 Ethernet, FDDI, Token
   Ring yes pop-up window, e-mail, SNMP trap CheckPoint, Lucent Mgmt.
   Server?
   NFR Network Flight Recorder December 1997 Ad hoc via third parties
   Manually via source code that user must compile TCP/IP DNS, HTTP, FTP,
   Telnet, SMTP, RSH Promiscuous x86 Most UNIXes (including many x86
   variants) 10/100 Ethernet, FDDI no paging, e-mail, fax, pop-up window
   ?
   Security Dynamics Kane Security Monitor 1997 By product release
   Included in product release N/A audit trails, event logs, NT SAM
   database, NT registry, NT system/app/security logs, account policies
   End-node End-node NT, NetWare N/A no audio, pop-up window, e-mail,
   pager ?
   AXENT Omniguard Intruder Alert 1992 Every 1 or 2 weeks Manually via
   encrypted web N/A audit trails, file alteration, Cisco router events,
   su, firewall events End-node End-node NT, NetWare, AIX, Digital UNIX,
   HP-UX, Solaris) N/A no paging, e-mail, pop-up window Tivoli TME 10,
   BMC PATROL, HP OV
          
  4.2.1 CyberCop by Network Associates, Inc.
  
                I see that a lot of people are misinformed about
                CyberCop. The CyberCop IDS was a product originally
                created at Network General (the Sniffer folks) with a
                web/Java front-end based upon intrusion detection
                technology licensed from WheelGroup. Network Associates
                bought Network General, and Cisco bought WheelGroup. For
                whatever reason, Cisco has declined to renew the license
                agreement. Therefore, as far as I can tell, Network
                Associates is no longer selling the original product.
                
                However, Network Associates liked the "CyberCop" name so
                much they are using it for new products. They purchased a
                SATAN-style vulnerability scanner called Ballista (the
                company was Secure Networks) and renamed it "CyberCop
                Scanner".
                
                They also provide a product called "CyberCop Server",
                which is a non-network product that sits on Sun or NT
                servers looking for bad logons or file modification. I
                think this was from the company Haystack that NAI bought
                a while back.
                
                Goto http://www.nai.com for more information.
                
  4.2.2 RealSecure by Internet Security Systems (ISS), Inc.
  
                This is a software-only product running on a number of
                Windows and UNIX platforms. Goto http://www.iss.net for
                more information.
                
  4.2.3 NetRanger by WheelGroup/Cisco
  
                Unlike CyberCop and RealSecure, which promiscuously
                monitor traffic, NetRanger is a router that watches
                traffic flowing through it. WheelGroup was bought by
                Cisco, so one can assume you will see this software
                showing up in all their routers. Goto
                http://www.wheelgroup.com.
                
  4.2.4 Netective by Netect
  
                Goto http://www.netect.com.
                
  4.2.4 SessionWall-3 by AbirNet/Memco
  
                Goto http://www.abirnet.com.
                
  4.2.5 ID-Trak by Internet Tools, Inc.
  
                Goto http://www.internettools.com.
                
  4.2.6 SecureNet Pro by MimeStart
  
                Goto http://www.mimestar.com.
                
  4.2.8 Kane Security Monitor (KSM) by Security Dynamics
  
                Released in 1996.
                
  4.2.7 Network Flight Recorder
  
                More of a configurable toolkit than a plug-and-play
                intrusion detection system. Released in 1998.
                
4.3 What tools do intruders use to break into my systems?

  4.3.1 UNIX utilities
  
                These utilities either come with your favorite UNIX
                platform or you can download them for free.
                
              ping
                      to see if a host is alive.
                      
              traceroute
                      to find the route to the host
                      
              nslookup/dig
                      to discover all your DNS information
                      
              whois
                      finds out Internic registration information
                      
              finger
                      finds out who is logged in and info about users
                      
              rpcinfo
                      finds out what RPC services are running
                      
              showmount
                      display shares on a machine
                      
              SAMBA
                      displays info about WinNT SMB shares
                      
              telnet
                      the granddaddy of them all -- allows you to connect
                      and play with any text-based protocol (HTTP, FTP,
                      SMTP, etc.)
                      
  4.3.2 WinNT utilities
  
                All of the UNIX utilities mentioned above can be used
                with WinNT. There are also some WinNT specific ones.
                
              nbtstat
                      discovers NetBIOS information on remote machine
                      
              net view
                      is the LANMAN program that allows you to remotely
                      view WinNT shares
                      
  4.3.3 Hacking-specific utilities
  
                The standard toolkit for a intruder.
                
              netcat
                      is characterized as a "TCP/IP" Swiss Army Knife,
                      allows intruders to script protocol interactions,
                      especially text-based protocols.
                      
              crack / NTcrack / L0phtCrack / etc.
                      that crack network passwords (Dictionary or Brute
                      Force). These packages also contain utilities for
                      dumping passwords out of databases and sniffing
                      them off the wire.
                      
              Sniffing utilities
                      for watching raw network traffic, such as Gobbler,
                      tcpdump, or even an honest-to-god Network
                      Associates Sniffer Network Analyzer
                      
              TCP and UDP port scanners
                      for scanning/strobing/probing which TCP ports are
                      available. TCP port scanners can also run in a
                      number of stealth modes to evade loggers.
                      
              Ping sweepers
                      for pinging large numbers of machines to see which
                      ones are active.
                      
              Exploit packs
                      which are a set of one or more programs that know
                      how to exploit holes on systems (usually, once the
                      user is logged in).
                      
              Remote security auditors
                      such as SATAN that look for a number of well known
                      holes in machines all across the network.
                      
              War dialers
                      that dial lots of phone numbers looking for dial-in
                      ports.
                      
              NAT
                      is based upon the SAMBA code, and is useful for
                      discovering NetBIOS/SMB info from Windows and SAMBA
                      servers.
                      
              Scanners
                      are programs (like SATAN, ISS, CyberCop Scanner)
                      that probe the system for vulnerabilities. That
                      have a huge number of vulnerabilities they check
                      for and are generally automated, giving the hacker
                      that highest return for the minimal effort.
                      
4.2 What other free/shareware intrusion detection products should I be aware
of?

  4.2.1 tcpwrappers
  
                Tcpwrappers are an add-in for UNIX, and sit between inetd
                and services (like ftp, telnet, etc.). The inetd will
                first call tcpwrappers, which will do some authentication
                (by IP address) and logging. Then, tcpwrappers will call
                the actual service, if need be.
                
                                 6. Resources
                                       
6.1 Where can I find updates about new security holes?

  6.1.1 CERT (Computer Emergency Response Team)
  
                If it is a security problem, you will eventually see it
                appear in a CERT advisory. CERT (Computer Emergency
                Response Team) was set up by a number of universities and
                DARPA in response to the Morris Worm of 1988. Goto
                http://www.cert.org.
                
  6.1.2 AUSCERT (AUStralian Computer Emergency Response Team)
  
                AUSCERT is the AUStralian Computer Emergency Response
                Team. For registration information, see their web site
                on:
                
                http://www.auscert.org.au/
                
                For more details, contact AUSCERT directly on
                auscert@auscert.org.au.
                
  6.1.3 CIAC (Computer Incident Advisory Capability) by US Department of Energy
  
                Has a number of useful advisories. Goto
                http://www.ciac.org/.
                
6.2 What are some other security and intrusion detection resources?

  6.2.1 Purdue's COAST archive
  
                This is the best site on the net for learning about IDS
                and security in general. See
                http://www.cs.purdue.edu/coast,
                http://www.cs.purdue.edu/coast/intrusion-detection, and
                http://www.cs.purdue.edu/coast/ids.
                
  6.2.2 SANS Institute
  
                I think this may be the best site for security
                information for people who are not themselves hackers.
                Their target audience is MIS professionals who have to
                defend their networks. Goto http://www.sans.org/
                
  6.2.3 L0pht Heavy Industries
  
                These are some hackers with some pretty good tools and
                useful alerts, targeted at Windows. Goto
                http://www.l0pht.com
                
  6.2.4 Technical Incursion Countermeasures
  
                I like this site; it has a bunch of well organized info
                on intrusion (A.K.A. incursion). Goto http://www.ticm.com
                
  6.2.5 IDS mailing list
  
                Email "subscribe ids" to majordomo@uow.edu.au
                Email questions to ids-owner@uow.edu.au
                This is a nice, low-volume list with interesting
                discussions from time-to-time.
                
6.3 What are some sites that are interesting?

          Here are some sites that aggregate info from other sites. Could
          be worth a look.
          
  6.3.1 NIH security site
  
                Goto http://www.alw.nih.gov/Security/
                
  6.3.2 NTSecurity.net
  
                Goto http://www.ntsecurity.net/.
                
                                   7. Other
                                       
7.1 What are some problems with IDS?

          See
          http://www.nai.com/services/support/whitepapers/security/IDSpa
          per.pdf, a paper describing these problems.
          
  7.1.1 Slow scans
  
                Because of the volume of traffic on the wire, NIDS have
                difficulty maintaining long-term traffic logs. It is
                therefore difficult to detect "slow scans" (ping sweeps
                or port scans) where intruders scan one port/address
                every hour.
                
  7.1.2 Loaded segments
  
                Currently NIDS cannot keep up with heavily loaded
                100-mbps segments. Thus, while they are suitable for
                lightly loaded networks and WAN links, they have problems
                with heavily loaded segments.
                
  7.1.3 Switched networks
  
                Switched networks pose problems to NIDS, as well as
                network analysis in general. There are many solutions to
                this problem, but they aren't always satisfactory. Some
                solutions are:
                
              embed
                      Some products have been embedded directly into the
                      switch itself. However, this just exacerbates the
                      problem noted above about loaded segments. Switch
                      backplanes are rated at gigabits-per-second.
                      
              monitor port
                      Many switches have a "monitor port" for attaching
                      network analyzers. A NIDS can easily be added to
                      this port as well. An obvious problem is that the
                      port runs at a much lower speed than the switch
                      backplane, so the NIDS will not be able to see all
                      the traffic on a heavily loaded switch.
                      
              inter-switch connection
                      Since many switches are configured in a
                      hierarchical manner, pretty good detection can be
                      provided by putting a NIDS on the connections
                      between switches. However, most NIDS can only
                      handle a limited amount of bandwidth, and are
                      likely to be saturated in such cases.
                      
  7.1.4 Coordinated, low-bandwidth attacks
  
                Sometimes hackers get together and run a slow scan from
                multiple IP addresses. This make it difficult for an
                intrusion detection system from diagnosing an attack.
                
7.2 If I have a firewall, do I need intrusion detection?

          Yes, for many reasons. Some reasons are:
          + You never know when your firewall is misconfigured and
            intruders have penetrated you network unless you have
            intrusion detection.
          + You never know when hackers are attempting to attack your
            network (firewall logging isn't always enough).
          + Most corporate attacks come from inside the network.
          + Hackers can still get some packets through most firewalls
            (i.e. TCP ACK scanning).
          "Defense in depth, and overkill paranoia, are your friends."
          (quote by Bennett Todd <bet at mordor dot net>). Hackers are
          much more capable than you think; the more defenses you have,
          the better. And they still won't protect you from the
          determined hacker. They will, however, raise the bar on
          determination needed by the hackers.
   
7.2 If I have a intrusion detection, do I need firewall?

          Of course. Every corporation needs a well managed, single point
          of entry. Hackers are always running automated programs (like
          SATAN) on the Internet looking for holes. Without a firewall,
          these automated programs can detect and exploit holes literally
          in the blink of an eye.
   
7.3 What are some standardization/interoperability efforts?

  7.3.1 COAST audit trails format
  
                A much more narrowly defined effort that solves a
                specific problem. Hasn't produce proposals yet. See
                http://www.cs.purdue.edu/coast/projects/audit-trails-for
                mat.html
                
  7.3.2 Universal Format for Logger Messages
  
                Not much has been done since 1997. See
                http://www.myass.com/nic/drafts/draft-abela-ulm-02.txt.h
                tml
                
  7.3.3 IETF Intrusion Detection Working Group
  
                Charter:
                http://www.ietf.org/html.charters/idwg-charter.html
                Archive: http://www.semper.org/idwg-public/
                Subscribe: idwg-public-request@zurich.ibm.com
                
  7.3.4 CIDF (Common Intrusion Detection Framework)
  
                Has specified a lisp-like format for messages between
                "Event Generators", "Event Analyzers", "Event Databases",
                and "Response Units". Currently very theoretical with
                little industry input.


